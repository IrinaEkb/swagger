(function(){var n,t={}.hasOwnProperty,i=function(n,i){function u(){this.constructor=n}for(var r in i)t.call(i,r)&&(n[r]=i[r]);return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n};n=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,n),t.prototype.events={"submit .sandbox":"submitOperation","click .submit":"submitOperation","click .response_hider":"hideResponse","click .toggleOperation":"toggleOperationContent"},t.prototype.initialize=function(){},t.prototype.render=function(){var n,f,e,o,s,h,c,t,i,l,a,r,u;for(e=jQuery.inArray(this.model.httpMethod,this.model.supportedSubmitMethods())>=0,e||(this.model.isReadOnly=!0),$(this.el).html(Handlebars.templates.operation(this.model)),this.model.responseClassSignature&&this.model.responseClassSignature!=="string"?(h={sampleJSON:this.model.responseSampleJSON,isParam:!1,signature:this.model.responseClassSignature},s=new SignatureView({model:h,tagName:"div"}),$(".model-signature",$(this.el)).append(s.render().el)):$(".model-signature",$(this.el)).html(this.model.responseClass),n={isParam:!1},this.model.supportedContentTypes&&(n.produces=this.model.supportedContentTypes),this.model.produces&&(n.produces=this.model.produces),f=new ContentTypeView({model:n}),$(".content-type",$(this.el)).append(f.render().el),r=this.model.parameters,t=0,l=r.length;t<l;t++)o=r[t],this.addParameter(o);for(u=this.model.errorResponses,i=0,a=u.length;i<a;i++)c=u[i],this.addStatusCode(c);return this},t.prototype.addParameter=function(n){var t;return t=new ParameterView({model:n,tagName:"tr",readOnly:this.model.isReadOnly}),$(".operation-params",$(this.el)).append(t.render().el)},t.prototype.addStatusCode=function(n){var t;return t=new StatusCodeView({model:n,tagName:"tr"}),$(".operation-status",$(this.el)).append(t.render().el)},t.prototype.submitOperation=function(n){var i,e,p,o,w,s,b,h,r,u,f,t,k,d,c,l,a,v,ft,et,ot,st,ht,y,g,nt,tt,it,rt,ut=this;if(n!=null&&n.preventDefault(),o=$(".sandbox",$(this.el)),p=!0,o.find("input.required").each(function(){var n=this;return $(this).removeClass("error"),jQuery.trim($(this).val())===""?($(this).addClass("error"),$(this).wiggle({callback:function(){return $(n).focus()}}),p=!1):void 0}),p){for(r={},g=o.serializeArray(),c=0,ft=g.length;c<ft;c++)u=g[c],u.value!=null&&jQuery.trim(u.value).length>0&&(r[u.name]=u.value);if(b=o.children().find('input[type~="file"]').size()!==0,h=!1,e="application/json",this.model.consumes&&this.model.consumes.length>0)e=this.model.consumes[0];else{for(nt=this.model.parameters,l=0,et=nt.length;l<et;l++)u=nt[l],u.paramType==="form"&&(h=!0,e=!1);b?e=!1:this.model.httpMethod.toLowerCase()==="post"&&h===!1&&(e="application/json")}if(b){for(i=new FormData,tt=this.model.parameters,a=0,ot=tt.length;a<ot;a++)t=tt[a],t.paramType==="body"&&t.name!=="file"&&i.append(t.name,r[t.name]);$.each(o.children().find('input[type~="file"]'),function(n,t){return i.append($(t).attr("name"),t.files[0])}),console.log(i)}else if(h)for(i=new FormData,it=this.model.parameters,v=0,st=it.length;v<st;v++)t=it[v],r[t.name]&&i.append(t.name,r[t.name]);else for(i=null,rt=this.model.parameters,y=0,ht=rt.length;y<ht;y++)t=rt[y],t.paramType==="body"&&(i=r[t.name]);return log("bodyParam = "+i),w=null,s=this.model.supportHeaderParams()?(w=this.model.getHeaderParams(r),this.model.urlify(r,!1)):this.model.urlify(r,!0),log("submitting "+s),$(".request_url",$(this.el)).html("<pre>"+s+"<\/pre>"),$(".response_throbber",$(this.el)).show(),f={type:this.model.httpMethod,url:s,headers:w,data:i,contentType:e,dataType:"json",processData:!1,error:function(n,t,i){return ut.showErrorStatus(n,t,i)},success:function(n){return ut.showResponse(n)},complete:function(n){return ut.showCompleteStatus(n)}},k=$("td select[name=contentType]",$(this.el)).val(),k&&(f.contentType=k),d=$(".content > .content-type > div > select[name=contentType]",$(this.el)).val(),d&&(f.headers=f.headers!=null?f.headers:{},f.headers.accept=d),jQuery.ajax(f),!1}},t.prototype.hideResponse=function(n){return n!=null&&n.preventDefault(),$(".response",$(this.el)).slideUp(),$(".response_hider",$(this.el)).fadeOut()},t.prototype.showResponse=function(n){var t;return t=JSON.stringify(n,null,"\t").replace(/\n/g,"<br>"),$(".response_body",$(this.el)).html(escape(t))},t.prototype.showErrorStatus=function(n){return this.showStatus(n)},t.prototype.showCompleteStatus=function(n){return this.showStatus(n)},t.prototype.formatXml=function(n){var e,t,r,u,f,o,v,s,h,c,l,i,a;for(s=/(>)(<)(\/*)/g,c=/[ ]*(.*)[ ]+\n/g,e=/(<.+>)(.+\n)/g,n=n.replace(s,"$1\n$2$3").replace(c,"$1\n").replace(e,"$1\n$2"),v=0,t="",f=n.split("\n"),r=0,u="other",h={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},l=function(n){var f,c,e,o,i,s,l;return s={single:Boolean(n.match(/<.+\/>/)),closing:Boolean(n.match(/<\/.+>/)),opening:Boolean(n.match(/<[^!?].*>/))},i=function(){var n=[];for(e in s)l=s[e],l&&n.push(e);return n}()[0],i=i===void 0?"other":i,f=u+"->"+i,u=i,o="",r+=h[f],o=function(){var n,t,i;for(i=[],c=n=0,t=r;0<=t?n<t:n>t;c=0<=t?++n:--n)i.push("  ");return i}().join(""),f==="opening->closing"?t=t.substr(0,t.length-1)+n+"\n":t+=o+n+"\n"},i=0,a=f.length;i<a;i++)o=f[i],l(o);return t},t.prototype.showStatus=function(n){var t,i,r;try{t=$("<code />").text(JSON.stringify(JSON.parse(n.responseText),null,2)),i=$('<pre class="json" />').append(t)}catch(u){t=$("<code />").text(this.formatXml(n.responseText)),i=$('<pre class="xml" />').append(t)}return r=i,$(".response_code",$(this.el)).html("<pre>"+n.status+"<\/pre>"),$(".response_body",$(this.el)).html(r),$(".response_headers",$(this.el)).html("<pre>"+n.getAllResponseHeaders()+"<\/pre>"),$(".response",$(this.el)).slideDown(),$(".response_hider",$(this.el)).show(),$(".response_throbber",$(this.el)).hide(),hljs.highlightBlock($(".response_body",$(this.el))[0])},t.prototype.toggleOperationContent=function(){var n;return n=$("#"+Docs.escapeResourceName(this.model.resourceName)+"_"+this.model.nickname+"_"+this.model.httpMethod+"_"+this.model.number+"_content"),n.is(":visible")?Docs.collapseOperation(n):Docs.expandOperation(n)},t}(Backbone.View)}).call(this)